What was the fundamental problem of exchange in long distance trade during medieval times, and how did the merchant guild help overcome it? How did this contribute to the prosperity of the Venetian Republic and Portugal before 1700?